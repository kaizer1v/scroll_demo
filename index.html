<!DOCTYPE html>
<html>
<head>
  <title>Scrolling Sections</title>
  <link rel="stylesheet" type="text/css" href="css/bootstrap.min.css"/>
  <link rel="stylesheet" type="text/css" href="css/style.css"/>
</head>
<body>
<div class="container">
  <div id='graphic'>
    <div id='sections'>
      <section class="step">
        <div class="title">OpenVis Conf 2013</div>
        I did what no presenter should ever do: I watched my own talk.<br/><br/>My first visit to OpenVis Conf in 2013.
      </section>

      <section class="step">
        <div class="title">Filler Words</div>
        As expected, I could only focus on the flaws: the rushed speech, the odd phrases, and, most especially, all the filler words. In fact, I found 180 filler words in my 30 minute talk.
      </section>

      <section class="step">
        <div class="title">My Talk</div>
        Here are all 5,040 words of my talk.
      </section>

      <section class="step">
        <div class="title">My Stumbles</div>
        And here are all the fillers I used in those 30 minutes.
      </section>

      <section class="step">
        <div class="title">Um's, Ah's &amp; Uh's</div>
        I almost exclusively used these three fillers. Um's and Ah's made up over 80%, with Uh's trailing behind.
      </section>

      <section class="step">
        <div class="title">Fillers Over Time</div>
        I hoped that all these blunders were toward the beginning of my talk. And the data suggests that fewer fillers are used as I get into it. Perhaps the talk started out rough and improved as I found my groove.
      </section>

      <section class="step">
        <div class="title">Ramping Back Up</div>
        Unfortunately, the trend does not continue. Midway into the talk my Um's and Ah's spike. I continue to use them pretty consistently throughout the rest of the talk.
      </section>

      <section class="step">
        <div class="title">The Cough Effect</div>
        My theory is that at this critical halfway point in my talk, I heard a dry cough indicative of the audience's waning interest. This caused self-confidence to collapse and forced me out of my groove.<br/><br/>A competing theory is that I just hadn't practiced the last half of my speech as much.
      </section>

      <section class="step">
        <div class="title">Best of Luck to Me in 2015</div>
        The world may never know, or care, but hopefully these insights improve my speaking in 2015. Though preliminary results aren't looking so good.
      </section>
    </div>

    <!-- <span id='counter'>3</span> -->
    <!-- <svg id='vis'>
      <text x='50' y='40' id='counter' style='font-size: 4rem'>0</text>
      <circle r='50' fill='red' cx='70' cy='70'></circle>
    </svg> -->
    <div id='vis'>
      <!-- Viz over here -->
    </div>

    <div id="extra-space"></div>
  </div>
</div>


<script src="lib/d3.js"></script>
<!-- <script src="https://cdnjs.cloudflare.com/ajax/libs/d3/7.5.0/d3.min.js" integrity="sha512-+rnC6CO1Ofm09H411e0Ux7O9kqwM5/FlEHul4OsPk4QIHIYAiM77uZnQyIqcyWaZ4ddHFCvZGwUVGwuo0DPOnQ==" crossorigin="anonymous" referrerpolicy="no-referrer"></script> -->
<script src="js/scroller.js"></script>
<!-- <script src="js/sections.js"></script> -->
<!-- <script src="js/ditch.js"></script> -->
<script type="text/javascript">

(function() {
  let svg = d3.select("#vis")
    .append('svg')
    .attr('width', 1000)
    .attr('height', 950)
    .attr('opacity', 1)

  svg.append('circle')
    .attr('cx', 30)
    .attr('cy', 30)
    .attr('r', 20)

}())

const fn1 = () => {
  let svg = d3.select('#vis').select('svg circle')
    .transition()
    .attr('cx', 30)
    .attr('cy', 30)
    .attr('r', 20)
}

const fn2 = () => {
  let svg = d3.select('#vis').select('svg circle')
    .transition()
    .attr('cx', 80)
    .attr('cy', 80)
    .attr('r', 30)
}

activationFunctions = [
  fn1,
  fn2,
  () => { console.log('fn 3') },
  () => { console.log('fn 4') },
  () => { console.log('fn 5') },
  () => { console.log('fn 6') },
  () => { console.log('fn 7') },
  () => { console.log('fn 8') },
  () => { console.log('fn 9') }
]

let scroll = scroller().container(d3.select('#graphic'))
scroll(d3.selectAll('.step'))

let lastIndex,
    activeIndex = 0;

scroll.on('active', function(index) {
  d3.selectAll('.step')
    .transition().duration(200)
    .style('opacity', (d, i) => { return i === index ? 1 : 0.1 })

  activeIndex = index
  let sign = (activeIndex - lastIndex) < 0 ? -1 : 1;
  let scrolledSections = d3.range(lastIndex + sign, activeIndex + sign, sign);

  // trigger section based functions
  scrolledSections.forEach(i => {
    activationFunctions[i]();
  })
  lastIndex = activeIndex;
})

</script>
</body>
</html>
